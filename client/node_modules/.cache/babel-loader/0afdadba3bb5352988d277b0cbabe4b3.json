{"ast":null,"code":"import _regeneratorRuntime from\"G:/projects/entertain-me-redux/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"G:/projects/entertain-me-redux/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"G:/projects/entertain-me-redux/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{Redirect,useParams}from\"react-router-dom\";import{ADD_FRIEND,REMOVE_MOVIE,REMOVE_TV_SHOW,REMOVE_GAME}from\"../utils/mutations\";import{QUERY_SELF,QUERY_USER}from\"../utils/queries\";import{useQuery,useMutation}from\"@apollo/client\";import{Container,Card,Button,Row,Col}from\"react-bootstrap\";import MovieModal from'../components/MovieModal';import TvModal from'../components/TvModal';import GameModal from'../components/GameModal';import FriendList from\"../components/FriendsList\";import Auth from\"../utils/auth\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Profile=function Profile(){var _useParams=useParams(),userParam=_useParams.username;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showMovieTrailerModal=_useState2[0],setShowMovieTrailerModal=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),movieTrailerModalTitle=_useState4[0],setMovieTrailerModalTitle=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),showTvTrailerModal=_useState6[0],setShowTvTrailerModal=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),tvTrailerModalTitle=_useState8[0],setTvTrailerModalTitle=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),showGameTrailerModal=_useState10[0],setShowGameTrailerModal=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),gameTrailerModalTitle=_useState12[0],setGameTrailerModalTitle=_useState12[1];var _useMutation=useMutation(ADD_FRIEND),_useMutation2=_slicedToArray(_useMutation,1),addFriend=_useMutation2[0];var _useMutation3=useMutation(REMOVE_MOVIE),_useMutation4=_slicedToArray(_useMutation3,1),deleteMovie=_useMutation4[0];var _useMutation5=useMutation(REMOVE_TV_SHOW),_useMutation6=_slicedToArray(_useMutation5,1),deleteShow=_useMutation6[0];var _useMutation7=useMutation(REMOVE_GAME),_useMutation8=_slicedToArray(_useMutation7,1),deleteGame=_useMutation8[0];var _useQuery=useQuery(userParam?QUERY_USER:QUERY_SELF,{variables:{username:userParam}}),loading=_useQuery.loading,data=_useQuery.data;var userData=(data===null||data===void 0?void 0:data.me)||(data===null||data===void 0?void 0:data.user)||{};if(Auth.loggedIn()&&Auth.getUserData().data.username===userParam){return/*#__PURE__*/_jsx(Redirect,{to:\"/profile\"});}if(!Auth.loggedIn()){return/*#__PURE__*/_jsx(Redirect,{to:\"/\"});}if(!(userData===null||userData===void 0?void 0:userData.username)){return/*#__PURE__*/_jsx(\"h4\",{children:\"You need to be logged in to see this. Please select log in or sign up to view user profile page!\"});}if(loading){return/*#__PURE__*/_jsx(\"h2\",{children:\"Loading...\"});}// change the passed in value to something that can be unique to the content type ie. passed in value of mediaType and compare to favorite media array on user model\nvar handleDeleteMovie=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(movieId){var token;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:token=Auth.loggedIn()?Auth.retrieveToken():null;if(token){_context.next=3;break;}return _context.abrupt(\"return\",false);case 3:_context.prev=3;_context.next=6;return deleteMovie({variables:{movieId:movieId}});case 6:_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](3);console.error(_context.t0);case 11:case\"end\":return _context.stop();}}},_callee,null,[[3,8]]);}));return function handleDeleteMovie(_x){return _ref.apply(this,arguments);};}();var handleDeleteShow=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(showId){var token;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:token=Auth.loggedIn()?Auth.retrieveToken():null;if(token){_context2.next=3;break;}return _context2.abrupt(\"return\",false);case 3:_context2.prev=3;_context2.next=6;return deleteShow({variables:{tvShowId:showId}});case 6:_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](3);console.error(_context2.t0);case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[3,8]]);}));return function handleDeleteShow(_x2){return _ref2.apply(this,arguments);};}();var handleDeleteGame=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(gameId){var token;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:token=Auth.loggedIn()?Auth.retrieveToken():null;if(token){_context3.next=3;break;}return _context3.abrupt(\"return\",false);case 3:_context3.prev=3;_context3.next=6;return deleteGame({variables:{gameId:gameId}});case 6:_context3.next=11;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](3);console.error(_context3.t0);case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[3,8]]);}));return function handleDeleteGame(_x3){return _ref3.apply(this,arguments);};}();var handleClick=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return addFriend({variables:{id:userData._id}});case 3:_context4.next=8;break;case 5:_context4.prev=5;_context4.t0=_context4[\"catch\"](0);console.error(_context4.t0);case 8:case\"end\":return _context4.stop();}}},_callee4,null,[[0,5]]);}));return function handleClick(){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"main\",{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-row mb-3\",children:/*#__PURE__*/_jsxs(\"h2\",{className:\"bg-dark text-secondary p-3 display-inline-block text-center\",children:[\"Welcome to \",userParam?\"\".concat(userData.username,\"'s\"):'your',\" Profile!\"]})}),/*#__PURE__*/_jsx(\"div\",{className:\"btn-loc\",children:userParam&&/*#__PURE__*/_jsx(\"button\",{onClick:handleClick,size:\"lg\",children:\"Add Friend\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-12 col-lg-3 mb-3\",children:/*#__PURE__*/_jsx(FriendList,{username:userData.username,friendCount:userData.friendCount,friends:userData.friends})}),/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(\"h2\",{children:userData.favoriteMovies.length?\"Viewing \".concat(userData.favoriteMovies.length,\" saved \").concat(userData.favoriteMovies.length===1?\"Movie\":\"Movies\",\":\"):\"You have no saved Movies!\"}),/*#__PURE__*/_jsx(Row,{fluid:\"true\",children:userData.favoriteMovies.map(function(user){return/*#__PURE__*/_jsx(Col,{sm:3,children:/*#__PURE__*/_jsxs(Card,{style:{width:'18rem'},children:[/*#__PURE__*/_jsx(Card.Img,{src:user.moviePoster,alt:\"The poster for \".concat(user.movieName),variant:\"top\"}),/*#__PURE__*/_jsxs(Card.Body,{className:\"card-body\",children:[/*#__PURE__*/_jsx(Card.Title,{children:user.movieName}),/*#__PURE__*/_jsx(Card.Text,{children:user.movieDetails}),/*#__PURE__*/_jsxs(Card.Text,{children:[\"Rating: \",user.movieRating]}),Auth.loggedIn()&&/*#__PURE__*/_jsx(Button,{className:\"btn-block btn-danger\",onClick:function onClick(){return handleDeleteMovie(user.movieId);},children:\"Delete this Movie!\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:function onClick(){setShowMovieTrailerModal(true);setMovieTrailerModalTitle(user.movieName+\" Movie Trailer\");},children:\"Watch a trailer!\"})]})]},user.movieId)});})})]}),/*#__PURE__*/_jsx(MovieModal,{showMovieTrailerModal:showMovieTrailerModal,setShowMovieTrailerModal:setShowMovieTrailerModal,movieTrailerModalTitle:movieTrailerModalTitle,setMovieTrailerModalTitle:setMovieTrailerModalTitle}),/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(\"h2\",{children:userData.favoriteTvShows.length?\"Viewing \".concat(userData.favoriteTvShows.length,\" saved \").concat(userData.favoriteTvShows.length===1?\"T.V. show\":\"T.V. shows\",\":\"):\"You have no saved T.V. Shows!\"}),/*#__PURE__*/_jsx(Row,{fluid:\"true\",children:userData.favoriteTvShows.map(function(user){return/*#__PURE__*/_jsx(Col,{sm:3,children:/*#__PURE__*/_jsxs(Card,{style:{width:'18rem'},children:[/*#__PURE__*/_jsx(Card.Img,{src:user.tvShowPoster,alt:\"The poster for \".concat(user.tvShowName),variant:\"top\"}),/*#__PURE__*/_jsxs(Card.Body,{className:\"card-body\",children:[/*#__PURE__*/_jsx(Card.Title,{children:user.tvShowName}),/*#__PURE__*/_jsx(Card.Text,{children:user.tvShowDetails}),/*#__PURE__*/_jsxs(Card.Text,{children:[\"Rating: \",user.tvShowRating]}),Auth.loggedIn()&&/*#__PURE__*/_jsx(Button,{className:\"btn-block btn-danger\",onClick:function onClick(){return handleDeleteShow(user.tvShowId);},children:\"Delete this T.V. Show!\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:function onClick(){setShowTvTrailerModal(true);setTvTrailerModalTitle(user.tvShowName+\" Show Trailer\");},children:\"Watch a trailer!\"})]})]},user.tvShowId)});})})]}),/*#__PURE__*/_jsx(TvModal,{showTvTrailerModal:showTvTrailerModal,setShowTvTrailerModal:setShowTvTrailerModal,tvTrailerModalTitle:tvTrailerModalTitle,setTvTrailerModalTitle:setTvTrailerModalTitle}),/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(\"h2\",{children:userData.favoriteGames.length?\"Viewing \".concat(userData.favoriteGames.length,\" saved \").concat(userData.favoriteGames.length===1?\"game\":\"games\",\":\"):\"You have no saved Games!\"}),/*#__PURE__*/_jsx(Row,{fluid:\"true\",children:userData.favoriteGames.map(function(user){return/*#__PURE__*/_jsx(Col,{sm:3,children:/*#__PURE__*/_jsxs(Card,{style:{width:'18rem'},children:[/*#__PURE__*/_jsx(Card.Img,{src:user.gamePoster,alt:\"The poster for \".concat(user.gameName),variant:\"top\"}),/*#__PURE__*/_jsxs(Card.Body,{className:\"card-body\",children:[/*#__PURE__*/_jsx(Card.Title,{children:user.gameName}),/*#__PURE__*/_jsxs(Card.Text,{children:[\"Rating: \",user.gameRating]}),Auth.loggedIn()&&/*#__PURE__*/_jsx(Button,{className:\"btn-block btn-danger\",onClick:function onClick(){return handleDeleteGame(user.gameId);},children:\"Delete this Game!\"}),/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:function onClick(){setShowGameTrailerModal(true);setGameTrailerModalTitle(user.gameName+\" game Trailer\");},children:\"Watch a trailer!\"})]})]},user.gameId)});})})]}),/*#__PURE__*/_jsx(GameModal,{showGameTrailerModal:showGameTrailerModal,setShowGameTrailerModal:setShowGameTrailerModal,gameTrailerModalTitle:gameTrailerModalTitle,setGameTrailerModalTitle:setGameTrailerModalTitle})]})});};export default Profile;","map":{"version":3,"sources":["G:/projects/entertain-me-redux/client/src/pages/Profile.js"],"names":["React","useState","Redirect","useParams","ADD_FRIEND","REMOVE_MOVIE","REMOVE_TV_SHOW","REMOVE_GAME","QUERY_SELF","QUERY_USER","useQuery","useMutation","Container","Card","Button","Row","Col","MovieModal","TvModal","GameModal","FriendList","Auth","Profile","userParam","username","showMovieTrailerModal","setShowMovieTrailerModal","movieTrailerModalTitle","setMovieTrailerModalTitle","showTvTrailerModal","setShowTvTrailerModal","tvTrailerModalTitle","setTvTrailerModalTitle","showGameTrailerModal","setShowGameTrailerModal","gameTrailerModalTitle","setGameTrailerModalTitle","addFriend","deleteMovie","deleteShow","deleteGame","variables","loading","data","userData","me","user","loggedIn","getUserData","handleDeleteMovie","movieId","token","retrieveToken","console","error","handleDeleteShow","showId","tvShowId","handleDeleteGame","gameId","handleClick","id","_id","friendCount","friends","favoriteMovies","length","map","width","moviePoster","movieName","movieDetails","movieRating","favoriteTvShows","tvShowPoster","tvShowName","tvShowDetails","tvShowRating","favoriteGames","gamePoster","gameName","gameRating"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { Redirect, useParams } from \"react-router-dom\";\nimport {\n  ADD_FRIEND,\n  REMOVE_MOVIE,\n  REMOVE_TV_SHOW,\n  REMOVE_GAME,\n} from \"../utils/mutations\";\nimport { QUERY_SELF, QUERY_USER } from \"../utils/queries\";\nimport { useQuery, useMutation } from \"@apollo/client\";\nimport {\n  Container,\n  Card,\n  Button,\n  Row,\n  Col,\n} from \"react-bootstrap\";\nimport MovieModal from '../components/MovieModal';\nimport TvModal from '../components/TvModal';\nimport GameModal from '../components/GameModal';\nimport FriendList from \"../components/FriendsList\";\nimport Auth from \"../utils/auth\";\n\nconst Profile = () => {\n  const { username: userParam } = useParams();\n\n  const [showMovieTrailerModal, setShowMovieTrailerModal] = useState(false);\n  const [movieTrailerModalTitle, setMovieTrailerModalTitle] = useState('');\n  const [showTvTrailerModal, setShowTvTrailerModal] = useState(false);\n  const [tvTrailerModalTitle, setTvTrailerModalTitle] = useState('');\n  const [showGameTrailerModal, setShowGameTrailerModal] = useState(false);\n  const [gameTrailerModalTitle, setGameTrailerModalTitle] = useState('');\n\n  const [addFriend] = useMutation(ADD_FRIEND);\n  const [deleteMovie] = useMutation(REMOVE_MOVIE);\n  const [deleteShow] = useMutation(REMOVE_TV_SHOW);\n  const [deleteGame] = useMutation(REMOVE_GAME);\n\n  const { loading, data } = useQuery(userParam ? QUERY_USER : QUERY_SELF , {\n    variables: { username: userParam },\n  });\n\n  const userData = data?.me || data?.user || {};\n\n  if (Auth.loggedIn() && Auth.getUserData().data.username === userParam) {\n    return <Redirect to=\"/profile\" />;\n  }\n\n  if (!Auth.loggedIn()) {\n    return <Redirect to=\"/\" />;\n  }\n\n  if (!userData?.username) {\n    return (\n      <h4>\n        You need to be logged in to see this. Please select log in or sign up to\n        view user profile page!\n      </h4>\n    );\n  }\n\n  if (loading) {\n    return <h2>Loading...</h2>;\n  }\n\n  // change the passed in value to something that can be unique to the content type ie. passed in value of mediaType and compare to favorite media array on user model\n  const handleDeleteMovie = async (movieId) => {\n    const token = Auth.loggedIn() ? Auth.retrieveToken() : null;\n    \n    if (!token) {\n      return false;\n    }\n\n    try {\n      await deleteMovie({\n        variables: { movieId: movieId }\n      })\n    } catch (err) {\n      console.error(err)\n    }\n  };\n  \n  const handleDeleteShow = async (showId) => {\n    const token = Auth.loggedIn() ? Auth.retrieveToken() : null;\n    \n    if (!token) {\n      return false;\n    }\n\n    try {\n      await deleteShow({\n        variables: { tvShowId: showId }\n      })\n    } catch (err) {\n      console.error(err)\n    }\n  };\n\n  const handleDeleteGame = async (gameId) => {\n    const token = Auth.loggedIn() ? Auth.retrieveToken() : null;\n    \n    if (!token) {\n      return false;\n    }\n\n    try {\n      await deleteGame({\n        variables: { gameId: gameId }\n      })\n    } catch (err) {\n      console.error(err)\n    }\n  };\n\n  const handleClick = async () => {\n    try {\n      await addFriend({\n        variables: { id: userData._id },\n      });\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  return (\n    <main>\n      <div>\n        <div className=\"flex-row mb-3\">\n          <h2 className=\"bg-dark text-secondary p-3 display-inline-block text-center\">\n            Welcome to {userParam ? `${userData.username}'s` : 'your'} Profile!\n          </h2>\n        </div>\n        <div className=\"btn-loc\">\n          {userParam && (\n            <button onClick={handleClick} size=\"lg\">\n              Add Friend\n            </button>\n          )}\n        </div>\n        <div className=\"col-12 col-lg-3 mb-3\">\n          <FriendList \n            username={userData.username}\n            friendCount={userData.friendCount}\n            friends={userData.friends}\n          />\n        </div>\n      <Container>\n        <h2>\n          {userData.favoriteMovies.length\n            ? `Viewing ${userData.favoriteMovies.length} saved ${\n              userData.favoriteMovies.length === 1 ? \"Movie\" : \"Movies\"\n              }:`\n              : \"You have no saved Movies!\"}\n        </h2>\n        <Row fluid=\"true\">\n          {userData.favoriteMovies.map((user) => {\n            return (\n              <Col sm={3}>\n                <Card key={user.movieId} style={{ width: '18rem' }}>\n                  <Card.Img src={user.moviePoster} alt={`The poster for ${user.movieName}`} variant=\"top\" />\n                  <Card.Body className=\"card-body\">\n                      <Card.Title>{user.movieName}</Card.Title>\n                      <Card.Text>{user.movieDetails}</Card.Text>\n                      <Card.Text>Rating: {user.movieRating}</Card.Text>\n                      {Auth.loggedIn() && (\n                        <Button className=\"btn-block btn-danger\"\n                        onClick={() => handleDeleteMovie(user.movieId)}\n                        >Delete this Movie!\n                        </Button>\n                      )}\n                        <Button variant=\"primary\" \n                          onClick={() => {setShowMovieTrailerModal(true)\n                            setMovieTrailerModalTitle(user.movieName + \" Movie Trailer\"); }}\n                          >Watch a trailer!\n                        </Button>\n                  </Card.Body>\n                </Card>\n              </Col>\n            );\n          })}\n        </Row>\n      </Container>\n      <MovieModal\n        showMovieTrailerModal={showMovieTrailerModal}\n        setShowMovieTrailerModal={setShowMovieTrailerModal}\n        movieTrailerModalTitle={movieTrailerModalTitle}\n        setMovieTrailerModalTitle={setMovieTrailerModalTitle}\n        ></MovieModal>  \n      <Container>\n        <h2>\n          {userData.favoriteTvShows.length\n            ? `Viewing ${userData.favoriteTvShows.length} saved ${\n              userData.favoriteTvShows.length === 1 ? \"T.V. show\" : \"T.V. shows\"\n              }:`\n            : \"You have no saved T.V. Shows!\"}\n        </h2>\n        <Row fluid=\"true\">\n          {userData.favoriteTvShows.map((user) => {\n            return (\n              <Col sm={3}>\n                <Card key={user.tvShowId} style={{ width: '18rem' }}>\n                  <Card.Img src={user.tvShowPoster} alt={`The poster for ${user.tvShowName}`} variant=\"top\" />\n                  <Card.Body className=\"card-body\">\n                    <Card.Title>{user.tvShowName}</Card.Title>\n                    <Card.Text>{user.tvShowDetails}</Card.Text>\n                    <Card.Text>Rating: {user.tvShowRating}</Card.Text>\n                    {Auth.loggedIn() && (\n                      <Button className=\"btn-block btn-danger\"\n                      onClick={() => handleDeleteShow(user.tvShowId)}\n                      >\n                        Delete this T.V. Show!\n                      </Button>\n                    )}\n                    <Button variant=\"primary\" onClick={() => {setShowTvTrailerModal(true)\n                    setTvTrailerModalTitle(user.tvShowName + \" Show Trailer\"); }}\n                    >Watch a trailer!</Button>\n                  </Card.Body>\n                </Card>\n              </Col>\n            );\n          })}\n        </Row>\n      </Container>\n      <TvModal\n        showTvTrailerModal={showTvTrailerModal}\n        setShowTvTrailerModal={setShowTvTrailerModal}\n        tvTrailerModalTitle={tvTrailerModalTitle}\n        setTvTrailerModalTitle={setTvTrailerModalTitle}\n        ></TvModal>\n      <Container>\n        <h2>\n          {userData.favoriteGames.length\n            ? `Viewing ${userData.favoriteGames.length} saved ${\n              userData.favoriteGames.length === 1 ? \"game\" : \"games\"\n            }:`\n            : \"You have no saved Games!\"}\n        </h2>\n        <Row fluid=\"true\">\n          {userData.favoriteGames.map((user) => {\n            return (\n              <Col sm={3}>\n                <Card key={user.gameId} style={{ width: '18rem' }}>\n                  <Card.Img src={user.gamePoster} alt={`The poster for ${user.gameName}`} variant=\"top\" />\n                  <Card.Body className=\"card-body\">\n                  <Card.Title>{user.gameName}</Card.Title>\n                    <Card.Text>Rating: {user.gameRating}</Card.Text>\n                    {Auth.loggedIn() && (\n                      <Button className=\"btn-block btn-danger\"\n                      onClick={() => handleDeleteGame(user.gameId)}\n                      >\n                      Delete this Game!\n                    </Button>\n                    )}\n                    <Button variant=\"primary\" \n                    onClick={() => {setShowGameTrailerModal(true)\n                    setGameTrailerModalTitle(user.gameName + \" game Trailer\"); }}\n                    >\n                      Watch a trailer!\n                    </Button>\n                  </Card.Body>\n                </Card>\n              </Col>   \n            );\n          })}\n        </Row>\n      </Container>\n      <GameModal\n        showGameTrailerModal={showGameTrailerModal}\n        setShowGameTrailerModal={setShowGameTrailerModal}\n        gameTrailerModalTitle={gameTrailerModalTitle}\n        setGameTrailerModalTitle={setGameTrailerModalTitle}\n      ></GameModal> \n      </div>\n    </main>\n  );\n};\n\nexport default Profile;\n"]},"metadata":{},"sourceType":"module"}